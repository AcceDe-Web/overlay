/**
 * @accedeweb/modal - WAI-ARIA modal plugin based on AcceDe Web instructions
 * @version v0.0.0
 * @link http://a11y.switch.paris/
 * @license ISC
 **/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Modal=e()}(this,function(){"use strict";var t="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, [tabindex], [contentEditable]",e={set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=arguments[1];if(!e.disabledElements){var o=[],n=[];Array.prototype.forEach.call(e.querySelectorAll(t),function(t){if(!(i&&i.contains(t)||t.closest("[hidden]"))){var e=parseInt(t.getAttribute("tabindex"),10);if(e){if(e<0)return;t.defaultTabindex=e}o.push(t),t.setAttribute("tabindex","-1")}}),e.disabledElements=o.length?o:null,i?Array.prototype.forEach.call(i.parentNode.children,function(t){if("SCRIPT"!==t.nodeName&&t!==i){var e=t.getAttribute("aria-hidden");if(e){if("true"===e)return;t.defaultAriaHidden=e}t.setAttribute("aria-hidden","true"),n.push(t)}}):(e.setAttribute("aria-hidden","true"),n.push(e)),e.hiddenElements=n.length?n:null}},unset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=e.disabledElements||Array.prototype.slice.call(e.querySelectorAll(t)),o=e.hiddenElements||[e];i.forEach(function(t){var e=t.defaultTabindex;e?(t.setAttribute("tabindex",e),t.defaultTabindex=null):t.removeAttribute("tabindex")}),e.disabledElements=null,o.forEach(function(t){var e=t.defaultAriaHidden;e?(t.setAttribute("aria-hidden",e),t.defaultAriaHidden=null):t.removeAttribute("aria-hidden")}),e.hiddenElements=null},focusables:t},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=["hide","show"],n=function(t,e){if(this.listeners={keydown:this.handleKeydown.bind(this),click:this.handleClick.bind(this),close:this.handleClose.bind(this)},this.callbacks={},e=arguments[1]||"object"===i(arguments[0])?arguments[0]:{},!(t=e!==arguments[0]?arguments[0]:void 0)&&!e)throw new Error("No parameter passed.");return e.modal||(e.modal=!0),this.options=e,this.init(t),{el:this.el,options:this.options,show:this.show.bind(this),hide:this.hide.bind(this),on:this.on.bind(this),off:this.off.bind(this)}};return n.modalIndex=0,n.modalCount=0,n.prototype.bind=function(){var t=this;this.el.addEventListener("keydown",this.listeners.keydown,!0),this.el.addEventListener("click",this.listeners.click),this.el.closeBtns.forEach(function(e){e.addEventListener("click",t.listeners.close)})},n.prototype.createDom=function(){var t=document.createElement(this.options.tagName||"div");if(this.options.className&&(t.className+=this.options.className),t.setAttribute("aria-hidden","true"),this.options.modal&&t.setAttribute("aria-modal","true"),this.options.dom&&("string"==typeof this.options.dom?t.innerHTML=this.options.dom:t.appendChild(this.options.dom)),this.options.label&&t.setAttribute("aria-label",this.options.label),this.options.role){t.setAttribute("role",this.options.role);var e=n.modalIndex;if(!this.options.label&&!t.hasAttribute("aria-labelledby")&&!t.hasAttribute("aria-label")){var i=t.querySelector(this.options.titleSelector||"[data-label]"),o=void 0;i&&(o=i.id||"modalTitle"+e,i.id=o,t.setAttribute("aria-labelledby",o))}if(!t.hasAttribute("aria-describedby")){var s=t.querySelector("[data-description]"),l=void 0;s&&(l=s.id||"modalDescription"+e,s.id=l,t.setAttribute("aria-describedby",l))}}return t},n.prototype.disableDocument=function(){this.documentDisabled=!0,e.set(document.body,this.el)},n.prototype.enableDocument=function(){e.unset(document.body),this.documentDisabled=!1},n.prototype.enableModal=function(){e.unset(this.el)},n.prototype.findInteractiveElement=function(){var t=this;this.el.firstInteractiveElement=this.el.querySelector("[autofocus]"),this.el.firstInteractiveElement||(Array.prototype.some.call(this.el.querySelectorAll(e.focusables),function(e){var i=void 0;return t.el.closeBtns&&t.el.closeBtns.indexOf(e)>-1&&(i=e),!(!e.offsetWidth&&!e.offsetHeight||i)&&(t.el.firstInteractiveElement=e,!0)}),!this.el.firstInteractiveElement&&this.el.closeBtns&&(this.el.firstInteractiveElement=this.el.closeBtns[0]))},n.prototype.focus=function(){var t=this;this.el.firstInteractiveElement||this.findInteractiveElement(),window.requestAnimationFrame(function(){t.el.firstInteractiveElement.focus()})},n.prototype.handleClick=function(t){!1!==this.options.closeOnCancel&&t.target===this.el&&this.handleClose(t,"cancel")},n.prototype.handleClose=function(t,e){"alertdialog"===this.options.role&&"cancel"===e||(this.unbind(),this.trigger("hide",e),this.el.setAttribute("aria-hidden","true"),console.log(this.options.modal,n.modalCount),this.options.modal&&1===n.modalCount&&this.enableDocument(),n.modalCount--,this.options.opener.focus())},n.prototype.handleKeydown=function(t){return 27===t.keyCode&&!1!==this.options.closeOnCancel&&(this.handleClose(t,"cancel"),!0)},n.prototype.hide=function(){this.handleClose({type:"user"})},n.prototype.init=function(t){if(n.modalIndex++,this.el=t?this.initDom(t):this.createDom(),this.el.modal=this,this.el.closeBtns=Array.prototype.slice.call(this.el.querySelectorAll(this.options.closeSelector)),!this.el.closeBtns.length)throw new Error("You must provide a valid selector with the key `closeSelector`. A modal must have a close button");return this.options.role&&this.validateModal(),this.el.parentNode!==document.body&&document.body.appendChild(this.el),this},n.prototype.initDom=function(t){return this.options.role=t.getAttribute("role"),this.options.modal&&this.setAttribute("aria-modal","true"),t},n.prototype.off=function(t,e){if(this.callbacks[t]){var i=this.callbacks[t].indexOf(e);i<0||this.callbacks[t].splice(i,1)}},n.prototype.on=function(t,e){o.indexOf(t)<0||(this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e))},n.prototype.show=function(){n.modalCount++,this.bind(),this.options.opener=this.options.opener||document.activeElement,"svg"===this.options.opener.nodeName&&(this.options.opener=this.options.opener.parentNode),this.trigger("show"),"false"!==this.el.getAttribute("aria-hidden")&&this.el.setAttribute("aria-hidden","false"),this.focus(),1===n.modalCount&&this.options.modal&&!this.documentDisabled?this.disableDocument():this.documentDisabled&&this.options.dom&&this.enableModal()},n.prototype.trigger=function(t,e){var i=this;this.callbacks[t]&&this.callbacks[t].forEach(function(t){t(i,e)})},n.prototype.unbind=function(){var t=this;this.el.removeEventListener("keydown",this.listeners.keydown,!0),this.el.removeEventListener("click",this.listeners.click),this.el.closeBtns.forEach(function(e){e.removeEventListener("click",t.listeners.close)})},n.prototype.validateModal=function(){var t=this.el.getAttribute("aria-label"),e=this.el.getAttribute("aria-describedby"),i=void 0;if((!t||t&&t.trim().length<0)&&(!(i=this.el.querySelector("#"+this.el.getAttribute("aria-labelledby")))||!this.el.contains(i)))throw new Error('No title is present in the modal. Use the "data-label" attribute on the visible title or pass the label using the "label" key when showing the modal.');if("alertdialog"===this.options.role&&!e)throw new Error('"alertdialog" modal needs a description, use the "data-description" attribute on the text content of the modal to validate the modal.')},n});
